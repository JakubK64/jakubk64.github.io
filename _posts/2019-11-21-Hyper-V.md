---
layout: post
title: Creating Virtual Machine with Hyper-V
published: true
tags: Hyper-V tutorial PL poradnik wirtualizacja maszyna wirtualna
---

### Start with Hyper-V

Hyper-V is a hypervisor built in Windows Operating System. To run Hyper-V you need to have at least:
- Windows 8 (prefered Windows 10) Pro, Enterprise or Education
- Hardware-assisted vitrualization
- minimum 4 GB RAM (preferd at least 8 GB)

To start using Hyper-V you need to enable it in Windows Features:

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/WindowsFeatures.PNG }}/CTF/Administracja/Hyper-V/Podstawy/WindowsFeatures.PNG)

After rebooting system you can run Hyper-V Manager app

### Creating Virtual Machine

The first server will be our computer. We can create on it first virtual machine (virtual computer which we can use for example as sandbox or just create computer
with other operating system).

On the right side of app we can see "Actions" menu:

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/ActionsHyper-V.PNG }}/CTF/Administracja/Hyper-V/Podstawy/ActionsHyper-V.PNG)

To create virtual machine we need to click New -> Virtual Machine

1. At first page we need to specify name and location, where we want to save our virtual machine (prefered ~20GB of space)

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/VMName.PNG }}/CTF/Administracja/Hyper-V/Podstawy/VMName.PNG)

2. Next we need to specify generation of machine. If we don't have any unusual task which need "old", first generation type machine, it is always better to choose Generation 2

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/VMGeneration.PNG }}/CTF/Administracja/Hyper-V/Podstawy/VMGeneration.PNG)

3. Next we need to specify RAM for our machine. If it is possible (you don't need to run many VM-s at one time and you don't have enough RAM on server etc.) always choose Dynamic Memory option. It allow computer to choose how much RAM virtual machine is currently needed. Usually it won't take more than 2-2,5 GB, usually ~1-1,5 GB.

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/VMRAM.PNG }}/CTF/Administracja/Hyper-V/Podstawy/VMRAM.PNG)

4. Next we can specify network connection. Let's stop here for a moment. 

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/VMNetwork.PNG }}/CTF/Administracja/Hyper-V/Podstawy/VMNetwork.PNG)

We have 3 types of network switches in Hyper-V and from beginning we have configured 2 of them.:
- Private ("Not Connected") which doesn't allow machine to contact with anything and anyone. It's simply disconnected device.
- External ("Default") which allow VM to connect to the internet as normal connected computer.
- Internal which we need to configure. It won't allow VM to connect to the internet but it allow to communicate with other VM-s which has the same switch.

We can create any of this switch in "Actions" menu using "Virtual Switch Manager"

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/VMSwitchManager.PNG }}/CTF/Administracja/Hyper-V/Podstawy/VMSwitchManager.PNG)

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/CreatingSwitch.PNG }}/CTF/Administracja/Hyper-V/Podstawy/CreatingSwitch.PNG)

5. Next we need to specify which disk for this machine we want to use. 

![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/VMDisk.PNG }}/CTF/Administracja/Hyper-V/Podstawy/VMDisk.PNG)

We have 3 types of disk in Hyper-V:
- Fixed size (static) which allow us to create static size disk which won't change size when you need more or less space
- Dynamically Expading (dynamic) which allow us to create disk which has at beginning 4096 KB and grow up with data stored on it. We don't waste space using this type of disk
- Differencing which allow us to create child-disk which take much more space than "normal" disk with VM. Differencing disk take only files which are necessary and rest stay at mother-disk with full data. It is the best option for example when you need to create 10 VM-s with the same operating system. You create on VM (let's name it FISH1) with basic Windows 10 and then create 9 differencing disks from FISH1 disk. Other 9 VM-s will create quicker and dont's take too much space on disk. When mother-disk on FISH1 will take 10-15 GB of space rest (child-disks) will take at beginning around 4 GB and system will normally work. You can also configure your mother-VM, install some programs, add to domain and then create differencing child-disks from it. Each child-disk will have the same configuration as mother.
  To use differencing disk we need to prepare it first clicking New -> Hard Disk in "Actions" menu 

6. In last step we need to choose .iso file with our operating system
![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/VMiso.PNG }}/CTF/Administracja/Hyper-V/Podstawy/VMiso.PNG)

Now VM configuration is done and we can see it in Hyper-V Manager:
![useful image]({{ https://github.com/JakubK64/jakubk64.github.io/blob/master/CTF/Administracja/Hyper-V/VM/VMchoose.PNG }}/CTF/Administracja/Hyper-V/Podstawy/VMchoose.PNG)

Last thing we need to do is right click on our VM and click Start. VM will install operating system and after a few minutes (depends on computer) VM will be ready to use.



																																	